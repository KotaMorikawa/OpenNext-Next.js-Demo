# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

Next.js 15.5.0 + SST (Serverless Stack) ã‚’ä½¿ç”¨ã—ãŸã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ¢ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€‚App Routerã€Turbopackã€TailwindCSS v4ã‚’æ¡ç”¨ã€‚

## å¿…é ˆé–‹ç™ºã‚³ãƒãƒ³ãƒ‰

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†
```bash
npm run db:up        # PostgreSQLèµ·å‹• (Docker)
npm run db:down      # PostgreSQLåœæ­¢
npm run db:logs      # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ­ã‚°ç¢ºèª
npm run db:studio    # Drizzle Studio (GUI)
npm run db:push      # ã‚¹ã‚­ãƒ¼ãƒé©ç”¨
```

### é–‹ç™ºãƒ»ãƒ“ãƒ«ãƒ‰
```bash
npm run dev          # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• (Turbopackä½¿ç”¨)
npm run build        # æœ¬ç•ªãƒ“ãƒ«ãƒ‰ (Turbopackä½¿ç”¨)
npm run start        # æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã®å®Ÿè¡Œ
```

### ãƒ†ã‚¹ãƒˆ
```bash
npm run test         # Vitestå®Ÿè¡Œ
npm run test:ui      # Vitest UI
npm run test:e2e     # Playwright E2E
npm run test:coverage # ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ã
```

### ã‚³ãƒ¼ãƒ‰å“è³ªç®¡ç†
```bash
npm run lint         # Biomeãƒªãƒ³ãƒˆå®Ÿè¡Œ
npm run format       # Biomeãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®Ÿè¡Œ
npm run typecheck    # TypeScriptå‹ãƒã‚§ãƒƒã‚¯
```

### ãƒ†ã‚¹ãƒˆæˆ¦ç•¥
- `npm run test`ã§Vitestã‚’ä½¿ç”¨ã—ã¦ãƒ†ã‚¹ãƒˆ
- ãƒ†ã‚¹ãƒˆç’°å¢ƒã¯jsdomã§æ§‹æˆ
- ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«: `test/setup.ts`
- ãƒ†ã‚¹ãƒˆã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨åŒã˜å ´æ‰€ã«é…ç½®ï¼ˆä¾‹ï¼š`app/page.test.tsx`ï¼‰
- ãƒ†ã‚¹ãƒˆã¯AAAãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆArrange, Act, Assertï¼‰ã§è¨˜è¿°
- è©³ç´°ã¯`docs/testing/frontend-unit-testing.md`ã‚’å‚ç…§


## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Next.js App Router + React 19 + TypeScript
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: TailwindCSS v4 + PostCSS  
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: PostgreSQL + Drizzle ORM
- **ãƒ†ã‚¹ãƒˆ**: Vitest + Playwright
- **ã‚¤ãƒ³ãƒ•ãƒ©**: SST 3.17.10 (AWS Lambda + CloudFront)
- **ã‚³ãƒ¼ãƒ‰å“è³ª**: Biome 2.2.0 (Lint + Format)

## ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

### TypeScriptè¨­å®š
- ãƒ‘ã‚¹ã‚¨ã‚¤ãƒªã‚¢ã‚¹: `@/*` â†’ `./src/*`
- Strict modeæœ‰åŠ¹
- Target: ES2017

### Biomeè¨­å®š
- ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ: 2ã‚¹ãƒšãƒ¼ã‚¹
- è‡ªå‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ•´ç†æœ‰åŠ¹
- Next.js/Reactæ¨å¥¨ãƒ«ãƒ¼ãƒ«é©ç”¨

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹
`docs/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€Next.js App Routerã¨ãƒ†ã‚¹ãƒˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒã‚ã‚Šã¾ã™ã€‚

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹æˆ

#### 1. Next.jsåŸºæœ¬åŸç†ã‚¬ã‚¤ãƒ‰ (`nextjs-principle/`)
Next.js App Routerã®åŒ…æ‹¬çš„ãªã‚¬ã‚¤ãƒ‰ï¼ˆå…¨36ç« ã€5éƒ¨æ§‹æˆï¼‰ï¼š

**Part 1: ãƒ‡ãƒ¼ã‚¿å–å¾— (11ç« )**
- **å‚ç…§ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã™ã‚‹éš›
- **ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«**:
  - `part_1_server_components.md` - Server Componentsè¨­è¨ˆã®åŸºæœ¬
  - `part_1_colocation.md` - ãƒ‡ãƒ¼ã‚¿å–å¾—ã®é…ç½®æˆ¦ç•¥
  - `part_1_request_memoization.md` - ãƒªã‚¯ã‚¨ã‚¹ãƒˆæœ€é©åŒ–
  - `part_1_concurrent_fetch.md` - ä¸¦è¡Œãƒ‡ãƒ¼ã‚¿å–å¾—
  - `part_1_data_loader.md` - DataLoaderãƒ‘ã‚¿ãƒ¼ãƒ³
  - `part_1_fine_grained_api_design.md` - APIè¨­è¨ˆæˆ¦ç•¥
  - `part_1_interactive_fetch.md` - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ¼ã‚¿å–å¾—

**Part 2: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ (5ç« )**
- **å‚ç…§ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚
- **ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«**:
  - `part_2_client_components_usecase.md` - Client Componentsä½¿ç”¨æŒ‡é‡
  - `part_2_composition_pattern.md` - ã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³
  - `part_2_container_presentational_pattern.md` - Container/Presentationalåˆ†é›¢
  - `part_2_container_1st_design.md` - Containerå„ªå…ˆè¨­è¨ˆ

**Part 3: ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ (6ç« )**
- **å‚ç…§ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ¶å¾¡æ™‚
- **ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«**:
  - `part_3_static_rendering_full_route_cache.md` - é™çš„ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æœ€é©åŒ–
  - `part_3_dynamic_rendering_data_cache.md` - å‹•çš„ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°åˆ¶å¾¡
  - `part_3_router_cache.md` - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  - `part_3_data_mutation.md` - ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹åŒ–
  - `part_3_dynamicio.md` - å®Ÿé¨“çš„ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ”¹å–„

**Part 4: ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æˆ¦ç•¥ (4ç« )**
- **å‚ç…§ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æœ€é©åŒ–ãƒ»Streamingå®Ÿè£…æ™‚
- **ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«**:
  - `part_4_pure_server_components.md` - Server Componentç´”ç²‹æ€§
  - `part_4_suspense_and_streaming.md` - ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
  - `part_4_partial_pre_rendering.md` - éƒ¨åˆ†çš„äº‹å‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

**Part 5: ãã®ä»–ã®å®Ÿè·µ (4ç« )**
- **å‚ç…§ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: èªè¨¼ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Ÿè£…æ™‚
- **ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«**:
  - `part_5_request_ref.md` - ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‚ç…§
  - `part_5_auth.md` - èªè¨¼ãƒ»èªå¯ãƒ‘ã‚¿ãƒ¼ãƒ³
  - `part_5_error_handling.md` - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥

#### 2. ãƒ†ã‚¹ãƒˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ (`testing/`)
**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å˜ä½“ãƒ†ã‚¹ãƒˆ** (`testing/frontend-unit-testing.md`)
- **å‚ç…§ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ç­–å®šãƒ»ãƒ†ã‚¹ãƒˆå®Ÿè£…æ™‚
- **å†…å®¹**:
  - Classical vs London school ãƒ†ã‚¹ãƒˆæ‰‹æ³•
  - AAAï¼ˆArrange, Act, Assertï¼‰ãƒ‘ã‚¿ãƒ¼ãƒ³
  - Storybookã¨ã®çµ±åˆï¼ˆ`composeStories`ï¼‰
  - ãƒ†ã‚¹ãƒˆå‘½åè¦å‰‡ãƒ»å…±é€šã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ‘ã‚¿ãƒ¼ãƒ³

### å‚ç…§ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

**å‚ç…§ã‚¿ã‚¤ãƒŸãƒ³ã‚°**:
- å®Ÿè£…æ™‚ã«ã¯é–¢é€£ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å¿…ãšå‚ç…§ã™ã‚‹
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ãŸã‚‰ã€ã€ŒğŸ“–{ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå}ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸã€ã¨å‡ºåŠ›ã™ã‚‹ã“ã¨

**æ©Ÿèƒ½å®Ÿè£…æ™‚ã®å‚ç…§å„ªå…ˆé †ä½**:
1. **ãƒ‡ãƒ¼ã‚¿å–å¾—å®Ÿè£…** â†’ Part 1ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¾¤ã‚’å‚ç…§
2. **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ** â†’ Part 2ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–** â†’ Part 3ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã‚’æ´»ç”¨
4. **ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æœ€é©åŒ–** â†’ Part 4ã®Streamingãƒ»PPRæˆ¦ç•¥ã‚’å‚ç…§
5. **èªè¨¼ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** â†’ Part 5ã®å®Ÿè·µãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨
6. **ãƒ†ã‚¹ãƒˆå®Ÿè£…** â†’ `testing/frontend-unit-testing.md`ã‚’å‚ç…§

### é‡è¦ãªè¨­è¨ˆåŸå‰‡

- **Server-First**: Server Componentsã‚’å„ªå…ˆã—ã€å¿…è¦æ™‚ã«Client Componentsã‚’ä½¿ç”¨
- **ãƒ‡ãƒ¼ã‚¿å–å¾—ã®é…ç½®**: ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¿‘ãã§ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚’å®Ÿè¡Œ
- **ã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³**: é©åˆ‡ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†é›¢ã¨ã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ´»ç”¨
- **ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–å¼·åŒ–**: JavaScriptç„¡åŠ¹æ™‚ã§ã‚‚æ©Ÿèƒ½ã™ã‚‹è¨­è¨ˆã‚’å¿ƒãŒã‘ã‚‹